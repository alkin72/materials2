Варианты обработки редактирования документа прихода-расхода:

запись в таблицу остатков за месяц сделать логику подсчета по предыдущему месяцу если его нет проверить есть ли записи до предыдущего месяца.
Можно сделать поиск по материалу фильтровка по последней записи по дате взять дату и суммировать


